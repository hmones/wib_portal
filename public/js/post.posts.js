var curr_posts_page=2,curr_comments_page=[];$("#extra_posts").visibility({once:!1,observeChanges:!0,onBottomVisible:function(){var t=new RegExp("id=.*$"),e=window.location.search.substring(1);t.test(e)||$.ajax({method:"GET",url:posts_url,data:{page:curr_posts_page,_token:app_token}}).done(function(t){"Error"!=t&&(curr_posts_page++,$(t).hide().appendTo("#extra_posts").fadeIn(500))})}}),$(document).on("click",".load_more_comments_btn",function(){var t=$(this).attr("data-post-id"),e="/post/"+t+"/comments/";t in curr_comments_page||(curr_comments_page[t]=2),$.ajax({method:"GET",url:e,data:{page:curr_comments_page[t],_token:app_token}}).done(function(e){"Error"===e?$('.load_more_comments_btn[data-post-id="'+t+'"]').remove():(curr_comments_page[t]++,$(e).hide().appendTo('.extra.comments[data-post-id="'+t+'"]').fadeIn(500))})}),$(document).on("click","#create_new_post",function(){var t=$(this).closest("form");t.addClass("loading"),$.ajax({method:"POST",url:"/post",data:{content:t.find("textarea[name=content]").val(),post_type:t.find("input[name=post_type]").val(),country_id:t.find("input[name=country_id]").val(),sector_id:t.find("input[name=sector_id]").val(),user_id:t.find("input[name=user_id]").val(),_token:t.find("input[name=_token]").val()}}).done(function(t){$(t).hide().prependTo("#new_posts").fadeIn(1e3)}),$(this).closest("form").removeClass("loading").trigger("reset")}),$(document).on("click",".trash.icon",function(){var t=$(this).attr("data-post-id");$.ajax({method:"POST",url:"/post/"+t,data:{_token:app_token,_method:"DELETE"}}).done(function(e){$("#post_"+t).fadeOut(1e3)})}),$(document).on("click",".create.comment.btn",function(){$(this).closest("form").trigger("submit")}),$(document).on("submit",".ui.form.create.comment",function(t){t.preventDefault();var e=$(this);e.addClass("loading"),$.ajax({method:"POST",url:"/comment",data:{content:e.find("input[name=content]").val(),commentable_type:e.find("input[name=commentable_type]").val(),commentable_id:e.find("input[name=commentable_id]").val(),user_id:e.find("input[name=user_id]").val(),_token:e.find("input[name=_token]").val()}}).done(function(t){e.siblings(".ui.feed.old.comments").find("span").remove(),$(t).hide().prependTo(".new.comments[data-post-id="+e.find("input[name=commentable_id]").val()+"]").fadeIn(1e3)}),e.removeClass("loading").trigger("reset")}),$(document).on("click","a.delete.comment.btn",function(){var t=$(this).attr("data-comment-id");$.ajax({method:"POST",url:"/comment/"+t,data:{_token:app_token,_method:"DELETE"}}).done(function(e){$(".event.ui.comment[data-id="+t+"]").fadeOut(1e3)})}),$(document).on("click","a.thumbs.up.button",function(){var t=$(this),e=t.attr("data-type"),n=t.attr("data-id"),a=t.attr("data-reaction-id"),o=t.attr("data-user-id"),i=t.parent().siblings("div.left.floated.column").children("span.likes.count"),d=parseInt(i.html());0!=a?$.ajax({method:"POST",url:"/reaction/"+a,data:{_token:app_token,_method:"DELETE"}}).done(function(e){d--,t.attr("data-reaction-id",0).removeClass("teal"),i.html(d--)}):$.ajax({method:"POST",url:"/reaction/",data:{_token:app_token,reactionable_type:e,reactionable_id:n,type:0,user_id:o}}).done(function(e){d++,t.attr("data-reaction-id",e.id).addClass("teal"),i.html(d++)})});
